- [Виды сетевой топологии:](#%D0%92%D0%B8%D0%B4%D1%8B%20%D1%81%D0%B5%D1%82%D0%B5%D0%B2%D0%BE%D0%B9%20%D1%82%D0%BE%D0%BF%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B8:)
	- [Как происходит запрос в гугл?](#%D0%9A%D0%B0%D0%BA%20%D0%BF%D1%80%D0%BE%D0%B8%D1%81%D1%85%D0%BE%D0%B4%D0%B8%D1%82%20%D0%B7%D0%B0%D0%BF%D1%80%D0%BE%D1%81%20%D0%B2%20%D0%B3%D1%83%D0%B3%D0%BB?)
- [Модели описывающие уровни протоколов:](#%D0%9C%D0%BE%D0%B4%D0%B5%D0%BB%D0%B8%20%D0%BE%D0%BF%D0%B8%D1%81%D1%8B%D0%B2%D0%B0%D1%8E%D1%89%D0%B8%D0%B5%20%D1%83%D1%80%D0%BE%D0%B2%D0%BD%D0%B8%20%D0%BF%D1%80%D0%BE%D1%82%D0%BE%D0%BA%D0%BE%D0%BB%D0%BE%D0%B2:)
	- [OSI](#OSI)
	- [TCP/IP](#TCP/IP)
		- [Уровни](#%D0%A3%D1%80%D0%BE%D0%B2%D0%BD%D0%B8)
		- [Общая схема передачи.](#%D0%9E%D0%B1%D1%89%D0%B0%D1%8F%20%D1%81%D1%85%D0%B5%D0%BC%D0%B0%20%D0%BF%D0%B5%D1%80%D0%B5%D0%B4%D0%B0%D1%87%D0%B8.)
- [Высокоуровневых протоколы](#%D0%92%D1%8B%D1%81%D0%BE%D0%BA%D0%BE%D1%83%D1%80%D0%BE%D0%B2%D0%BD%D0%B5%D0%B2%D1%8B%D1%85%20%D0%BF%D1%80%D0%BE%D1%82%D0%BE%D0%BA%D0%BE%D0%BB%D1%8B)
	- [HTTP (HyperText Transport Protocol)](#HTTP%20(HyperText%20Transport%20Protocol))
		- [Структура запросов](#%D0%A1%D1%82%D1%80%D1%83%D0%BA%D1%82%D1%83%D1%80%D0%B0%20%D0%B7%D0%B0%D0%BF%D1%80%D0%BE%D1%81%D0%BE%D0%B2)
		- [Примеры заголовков запроса:](#%D0%9F%D1%80%D0%B8%D0%BC%D0%B5%D1%80%D1%8B%20%D0%B7%D0%B0%D0%B3%D0%BE%D0%BB%D0%BE%D0%B2%D0%BA%D0%BE%D0%B2%20%D0%B7%D0%B0%D0%BF%D1%80%D0%BE%D1%81%D0%B0:)
		- [Примеры заголовков ответа:](#%D0%9F%D1%80%D0%B8%D0%BC%D0%B5%D1%80%D1%8B%20%D0%B7%D0%B0%D0%B3%D0%BE%D0%BB%D0%BE%D0%B2%D0%BA%D0%BE%D0%B2%20%D0%BE%D1%82%D0%B2%D0%B5%D1%82%D0%B0:)
		- [HTTPS](#HTTPS)
	- [DNS (Domain Name System)](#DNS%20(Domain%20Name%20System))
		- [Типы записей DNS-сервера](#%D0%A2%D0%B8%D0%BF%D1%8B%20%D0%B7%D0%B0%D0%BF%D0%B8%D1%81%D0%B5%D0%B9%20DNS-%D1%81%D0%B5%D1%80%D0%B2%D0%B5%D1%80%D0%B0)
		- [Типы DNS-серверов](#%D0%A2%D0%B8%D0%BF%D1%8B%20DNS-%D1%81%D0%B5%D1%80%D0%B2%D0%B5%D1%80%D0%BE%D0%B2)
			- [Типы DNS-запросов](#%D0%A2%D0%B8%D0%BF%D1%8B%20DNS-%D0%B7%D0%B0%D0%BF%D1%80%D0%BE%D1%81%D0%BE%D0%B2)
		- [FQDN (Fully Qualified Domain Name)](#FQDN%20(Fully%20Qualified%20Domain%20Name))
			- [Корневой домен](#%D0%9A%D0%BE%D1%80%D0%BD%D0%B5%D0%B2%D0%BE%D0%B9%20%D0%B4%D0%BE%D0%BC%D0%B5%D0%BD)
			- [Домен верхнего уровня (TLD)](#%D0%94%D0%BE%D0%BC%D0%B5%D0%BD%20%D0%B2%D0%B5%D1%80%D1%85%D0%BD%D0%B5%D0%B3%D0%BE%20%D1%83%D1%80%D0%BE%D0%B2%D0%BD%D1%8F%20(TLD))
			- [Домен второго уровня (SLD)](#%D0%94%D0%BE%D0%BC%D0%B5%D0%BD%20%D0%B2%D1%82%D0%BE%D1%80%D0%BE%D0%B3%D0%BE%20%D1%83%D1%80%D0%BE%D0%B2%D0%BD%D1%8F%20(SLD))
			- [Поддомен](#%D0%9F%D0%BE%D0%B4%D0%B4%D0%BE%D0%BC%D0%B5%D0%BD)
			- [Имя хоста](#%D0%98%D0%BC%D1%8F%20%D1%85%D0%BE%D1%81%D1%82%D0%B0)
		- [PQDN (Partially Qualified Domain Name)](#PQDN%20(Partially%20Qualified%20Domain%20Name))
	- [POP3 (Post Office Protocol Version 3)](#POP3%20(Post%20Office%20Protocol%20Version%203))
	- [IMAP (Internet Message Access Protocol)](#IMAP%20(Internet%20Message%20Access%20Protocol))
	- [SMTP (Simple Mail Transfer Protocol)](#SMTP%20(Simple%20Mail%20Transfer%20Protocol))
	- [Telnet (Terminal Network)](#Telnet%20(Terminal%20Network))
	- [SSH (Secure Shell)](#SSH%20(Secure%20Shell))
	- [FTP (File Transfer Protocol)](#FTP%20(File%20Transfer%20Protocol))
	- [TFTP (Trivial File Transfer Protocol)](#TFTP%20(Trivial%20File%20Transfer%20Protocol))
- [Протоколы транспортного уровня](#%D0%9F%D1%80%D0%BE%D1%82%D0%BE%D0%BA%D0%BE%D0%BB%D1%8B%20%D1%82%D1%80%D0%B0%D0%BD%D1%81%D0%BF%D0%BE%D1%80%D1%82%D0%BD%D0%BE%D0%B3%D0%BE%20%D1%83%D1%80%D0%BE%D0%B2%D0%BD%D1%8F)
	- [UDP (User Datagram Protocol)](#UDP%20(User%20Datagram%20Protocol))
	- [TCP (Transmissin Control Protocol)](#TCP%20(Transmissin%20Control%20Protocol))
- [Сетевой уровень](#%D0%A1%D0%B5%D1%82%D0%B5%D0%B2%D0%BE%D0%B9%20%D1%83%D1%80%D0%BE%D0%B2%D0%B5%D0%BD%D1%8C)
	- [IP (Internet Protocol)](#IP%20(Internet%20Protocol))
		- [IPv4](#IPv4)
		- [Частные IP-диапазоны](#%D0%A7%D0%B0%D1%81%D1%82%D0%BD%D1%8B%D0%B5%20IP-%D0%B4%D0%B8%D0%B0%D0%BF%D0%B0%D0%B7%D0%BE%D0%BD%D1%8B)
		- [Глобальные IP-адреса](#%D0%93%D0%BB%D0%BE%D0%B1%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D0%B5%20IP-%D0%B0%D0%B4%D1%80%D0%B5%D1%81%D0%B0)
		- [Маршрутизаторы](#%D0%9C%D0%B0%D1%80%D1%88%D1%80%D1%83%D1%82%D0%B8%D0%B7%D0%B0%D1%82%D0%BE%D1%80%D1%8B)
		- [Классовая адресация сетей](#%D0%9A%D0%BB%D0%B0%D1%81%D1%81%D0%BE%D0%B2%D0%B0%D1%8F%20%D0%B0%D0%B4%D1%80%D0%B5%D1%81%D0%B0%D1%86%D0%B8%D1%8F%20%D1%81%D0%B5%D1%82%D0%B5%D0%B9)
		- [Бесклассовая адресация сетей](#%D0%91%D0%B5%D1%81%D0%BA%D0%BB%D0%B0%D1%81%D1%81%D0%BE%D0%B2%D0%B0%D1%8F%20%D0%B0%D0%B4%D1%80%D0%B5%D1%81%D0%B0%D1%86%D0%B8%D1%8F%20%D1%81%D0%B5%D1%82%D0%B5%D0%B9)
		- [Широковещательный адрес в IP сети](#%D0%A8%D0%B8%D1%80%D0%BE%D0%BA%D0%BE%D0%B2%D0%B5%D1%89%D0%B0%D1%82%D0%B5%D0%BB%D1%8C%D0%BD%D1%8B%D0%B9%20%D0%B0%D0%B4%D1%80%D0%B5%D1%81%20%D0%B2%20IP%20%D1%81%D0%B5%D1%82%D0%B8)
		- [Обратная петля Loopback](#%D0%9E%D0%B1%D1%80%D0%B0%D1%82%D0%BD%D0%B0%D1%8F%20%D0%BF%D0%B5%D1%82%D0%BB%D1%8F%20Loopback)
		- [Маршрут по умолчанию](#%D0%9C%D0%B0%D1%80%D1%88%D1%80%D1%83%D1%82%20%D0%BF%D0%BE%20%D1%83%D0%BC%D0%BE%D0%BB%D1%87%D0%B0%D0%BD%D0%B8%D1%8E)
		- [Таблица маршрутизации](#%D0%A2%D0%B0%D0%B1%D0%BB%D0%B8%D1%86%D0%B0%20%D0%BC%D0%B0%D1%80%D1%88%D1%80%D1%83%D1%82%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D0%B8)
		- [Default free Zone (DFZ)](#Default%20free%20Zone%20(DFZ))
		- [NAT (Network Address Tranlator)](#NAT%20(Network%20Address%20Tranlator))
	- [ARP (Address Resolution Protocol)](#ARP%20(Address%20Resolution%20Protocol))
	- [ICMP (Internet Control Message Protocol)](#ICMP%20(Internet%20Control%20Message%20Protocol))
	- [DHCP (Dynamic Host Confuguration Protocol)](#DHCP%20(Dynamic%20Host%20Confuguration%20Protocol))
- [Канальный уровень](#%D0%9A%D0%B0%D0%BD%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D0%B9%20%D1%83%D1%80%D0%BE%D0%B2%D0%B5%D0%BD%D1%8C)
	- [Ethernet (CSMA/CD) протокол](#Ethernet%20(CSMA/CD)%20%D0%BF%D1%80%D0%BE%D1%82%D0%BE%D0%BA%D0%BE%D0%BB)
		- [MAC-адресация](#MAC-%D0%B0%D0%B4%D1%80%D0%B5%D1%81%D0%B0%D1%86%D0%B8%D1%8F)
	- [Свитч](#%D0%A1%D0%B2%D0%B8%D1%82%D1%87)
		- [Алгоритм работы](#%D0%90%D0%BB%D0%B3%D0%BE%D1%80%D0%B8%D1%82%D0%BC%20%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D1%8B)
- [Физический уровень](#%D0%A4%D0%B8%D0%B7%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B9%20%D1%83%D1%80%D0%BE%D0%B2%D0%B5%D0%BD%D1%8C)


https://miminet.ru/quiz/section/test/all?test_id=3
https://stepik.org/lesson/1366117/step/5?unit=1382113

В компьютерной сети все данные передаются пакетами, придумал Леонард Клейнрок в 1961 и назвал такой метод пакетная коммутация. Есть 2 способоа организации передачи информации:
- коммутация каналов
- пакетная коммутация

Ethernet был [придуман](https://ethernethistory.typepad.com/papers/ethernetbobmemo.pdf) в 1973 году инженером Робертом Меткалфом.

Коммутация каналов применяется обычно в телефонии. Предварительно для передачи данных необходимо установить соединение. После соединения можно передавать данные.

В пакетной коммутации каналы связи уже установлены и данные передаются от одного узла к другому. Перед отправкой данные разбиваются на отдельные фрагменты - пакеты. Каждый пакет состоит из заголовка и данных. 

Способы передачи данных:
- Симплексный метод - передаются данные только в одном направлении (радиовещание, GPS, ГЛОНАСС)
- Полудуплекс - канал передающий данные в обе стороны, но только в одно направление в один момент времени (рация)
- Полный дуплекс - передача данных в обе стороны одновременно

2 стандарта, которые отслеживают информацию о работе компьютерной сети.
- IEEE 802.* - все стандарты описывают технологии канального и физического уровней
- RFC (Request For Comments) - нумерованные документы, которые содержат программные технические спецификации от сетевого уровня и выше

IEEE - некоммерческая инженерная ассоциация США, разрабатывающая стандарты по радиоэлектронике, электротехнике и аппаратному обеспечению вычислительных систем и сетей. Их стандарты касаются локально вычислительных сетей LAN и сетей мегаполисов MAN.

Стандарт IEEE 802.11 - коммуникация в беспроводной локальной межсетевой зоне (Wi-Fi). 

IEEE 802.11n - передача данных по частотам 2.4 ГГц и 5 ГГц при скорости для одного из каналов до 150 Мбит/сек
IEEE 802.11ac - передача данных на частоте 5 ГГц при скорости до 867 Мбит/сек для одного из каналов.

IEEE 802.3 - проводная технология передачи данных CSMA/CD. 



**CDN** (**Content** **Delivery** **Network**) - это географически распределённая сетевая инфраструктура, обеспечивающая быструю доставку контента пользователям веб-сервисов и сайтов. Входящие в состав CDN cерверы географически располагаются таким образом, чтобы сделать время ответа для пользователей сайта/сервиса минимальным.

**Ориджин (origin)** — сервер, на котором хранятся исходные файлы или данные, раздаваемые через CDN.  
  
**PoP (point of presence, точка присутствия)** — кэширующий сервер в составе CDN, расположенный в определенной географической локации. Для обозначения таких серверов также используется термин edge.  
  
**Динамический контент** ― контент, генерируемый на сервере в момент получения запроса (либо изменяемый пользователем, либо загружаемый из базы данных).  
  
**Статический контент** ― контент, хранимый на сервере в неизменяемом виде (например, бинарные файлы, аудио- и видеофайлы, JS и CSS).

**Сетевая топология** - конфигурация графа, вершинами которого соответствуют конечные узлы сети (компьютеры) и коммуникационное оборудование (маршрутизаторы), а ребрами физические или информационные связи между вершинами
 
![[Pasted image 20250213020132.png]]

# Виды сетевой топологии:
- физическая - описывает реально расположение и связи между узлами сети
- логическая - описывает хождение сигнала в рамках физической топологии
- информационной - описывает направление потоков информации, передаваемой по сети
- управление обменом - принцип передачи права на пользование сетью

Топологии:
- **полносвязная**

![[Pasted image 20250213022126.png]]
- **неполносвязная**
	- *шина*
	- ![[Pasted image 20250213022409.png]]
	- *звезда*
	- ![[Pasted image 20250213022415.png]]
	- *кольцо*
	- ![[Pasted image 20250213022420.png]]
- **ячеистая топология** - Получается из полносвязной топологии путём удаления некоторых связей. Допускает соединения большого количества компьютеров и характерна для крупных сетей.
- **смешанная топология**
- ![[Pasted image 20250213022443.png]]

Вспомогательное устройство для топологии _звезды_:
- **концентратор** (старое) - объединение компьютеров с применением кабельной инфраструктуры типа витая пара (патч корд) - работает на физическом уровне сетевой модели OSI
- **коммутатор** (свитч) - работает на втором канальном  уровне OSI

## Как происходит запрос в гугл?

![[Pasted image 20250213024204.png]]

Идет запрос к провайдеру, от провайдера к его родительскому и тд
Множество провайдеров объединены через хабы - точки обмена трафиком

![[Pasted image 20250213024541.png]]

**Точки обмена трафиком** - сетевая инфраструктура предназначенная для оперативной организации соединений и межоператорского обмена сетевым трафиком между независимыми сетями в Интернете. Участниками обмена трафиком обычно являются организации, управляющие независимыми сетями.
**Пиринг** - соглашение интернет-операторов об обмене трафиком между своими сетями, а также техническое взаимодействие, реализующее данное соглашение: соединение сетей и обмен информацией о сетевых маршрутах по протоколу [BGP](https://ru.wikipedia.org/wiki/Border_Gateway_Protocol "Border Gateway Protocol")(https://ru.wikipedia.org/wiki/%D0%9F%D0%B8%D1%80%D0%B8%D0%BD%D0%B3#cite_note-1).

Интернет построен на коммутации пакетов. Коммутация пакетов - способ динамического распределения ресурсов сети связи за счёт передачи и коммутации оцифрованной информации в виде частей небольшого размера.

**Протокол** - набор правил определяющий как узлы сети должны передавать данные друг другу. 

Пример высокоуровневых протоколов: **HTTP**, **SSH**, **IMAP**, **DHCP**, **DNS**, **SMTP**, **POP3**, **Telnet**, **FTP**, **TFTP**

# Модели описывающие уровни протоколов:
- ***OSI*** (Open System Interconnection) - теоретическая
- ***TCP/IP*** (Transmission Control Protocol / Internet Protocol) - практическая

## OSI

7 уровней работают снизу вверх 

![[Pasted image 20250213141404.png]]

1. **Физический уровень** - определяет метод передачи данных, какая среда используется (передача электрических сигналов), уровень напряжения, метод кодирования двоичных сигналов.
2. **Канальный уровень** - задача адресации в пределах локальной сети, обнаруживает ошибки, проверяет целостность данных. (MAC - адрес, протокол Ethernet). Передаваемая информация - кадры.
3. **Сетевой уровень** - объединение участков сети и выбор оптимального пути (маршрутизация). Каждое устройство должно иметь уникальный сетевой адрес в сети. (протоколы IPv4 IPv6)
4. **Транспортный уровень** - передача сегментов файлов, порты, протоколы TCP, UDP. Информация транспортного называется сегменты. Применимо только для TCP, для UDP - датаграмма. Разница в названии не критична.
5. **Сеансовый уровень** - установление, управление и разрыв соединений между хостами. виде. Передаваемая информация обозначается как PDU (Protocol Data Units)
6. **Уровень представления** - структурирование информации в читабельный вид для прикладного уровня. виде. Передаваемая информация обозначается как PDU (Protocol Data Units)
7. **Прикладной уровень** - вывод информации пользователю в понятном виде. Передаваемая информация обозначается как PDU (Protocol Data Units)

Все процессы строго проходят друг за другом. С верхнего на нижний инкапсуляция, с нижнего на верхний деинкапсуляция. 

## TCP/IP

![[Pasted image 20250213143620.png]]

### Уровни
1. Application Layer (прикладной уровень)
2. Transport Layer (транспортный уровень)
3. Network Layer (сетевой уровень)
4. Link Layer (канальный уровень)


### Общая схема передачи.
1. Генерируется сообщение на уровне приложения 
2. Передача на транспортный уровень, добавляется TCP/UDP заголовок. Заголовок хранит в себе информацию о портах, нагрузке и тд. Получается датаграмма или сегмент
3. Передача на межсетевой уровень. Добавляется IP-заголовок. Заголовок содержит в себе адреса компьютеров, на которых запущено приложение. Результат объединения сегмента и IP-заголовка называется пакетов.
4. Передача на канальный уровень. Протоколы добавляют свои заголовки и в результате получается кадр. Кадр обычно содержит в себе не только заголовок, но и окончание

![[Pasted image 20250213144821.png]]

Когда кадр передаётся от одного промежуточного узла сети к другому, эти узлы разбирают кадр на части, проверяют IP-заголовок пакета, определяют что с ним делать, а затем создают новый кадр для этого пакета и передают его следующему узлу.

![[Pasted image 20250213144858.png]]

Самые важные транспортные протоколы TCP (Transmission Control Protocol), UDP (User Datagram Protocol)

Протоколы транспортного уровня используются для адресации пакетов с порта приложения отправителя на порт приложения получателя

# Высокоуровневых протоколы
## HTTP (HyperText Transport Protocol)
Протокол передачи данных, обычно используется для получения веб информации. Используется "клиент-серверная" модель (клиент формирует и отправляет запрос, сервер слушает запросы и отвечает на них). Клиент - браузер (Firefox, Google Chrome ...), сервер (используемое ПО: apache, nginx, IIS). Используются версии HTTP/2, HTTP/1.1.
Данные между клиентом и сервером передаются с помощью HTTP-сообщений:
- **Запросы (HTTP Requests)** — сообщения, которые отправляются клиентом на сервер, чтобы вызвать выполнение некоторых действий. Зачастую для получения доступа к определенному ресурсу. Основой запроса является HTTP-заголовок.
- **Ответы (HTTP Responses)** — сообщения, которые сервер отправляет _в ответ_ на клиентский запрос.
### Структура запросов
Для запросов и ответов структура совпадает
1. **Стартовая строка (start line)** - описание версии, используемый протокол, запрашиваемый ресурс, код ответа, занимает одну строку
	*Методы HTTP-запроса*:
		- GET
		- POST
		- HEAD - возвращает заголовок и тело
		- PUT
		- DELETE
		- OPTIONS - получение информации о сервере, допустимой информации
		- PATCH
	*Цель запроса*: указатель ресурса URL (Iniform Resource Locator) (состоит из протокола, доменного имени (или IP-адреса), пути к конкретному ресурсу на сервере). Дополнительно может содержать порт, несколько параметров, опциональные элементы
	*Версия HTTP*: 
	- 1.1 недостатки:
		- заголовки не сжаты
		- заголовки совпадали и повторно отправлялись
		- отсутствие мультиплексирования - механизм объединения нескольких соединений в одном потоке данных
	- 2 - сообщения разбиваются на фреймы. Фреймы данных (тела сообщения) отделялись от фреймов заголовка, что позволило применять сжатие. Вместе с появлением потоков появился и ранее описанный механизм мультиплексирования — теперь можно было обойтись одним соединением для нескольких потоков. Работает с сырой двоичной формой данных
	![[Pasted image 20250220013155.png]]
2. HTTP-заголовки (HTTP Headers) - строки текста для уточнения запроса/описание содержимого тела сообщения
Структура key:value
	Категории заголовков:
		- Общего назначения - применяются ко всему сообщению целиком
		- Заголовки запроса - уточняют информацию о запросе, сообщая доп. контекст или ограничивая его некоторыми  логическими условиями
		- Заголовки представления - описывают формат данных сообщения и используемую кодировку. Передается при наличии тела.
1. Пустая строка - сообщение, что все метаданные для конкретного запроса или ответа были отправлены
2. Тело сообщения (опционально) - данные, связанные с запросом/документ передаваемый в ответе

![[Pasted image 20250220013832.png]]

URL: 
- *Scheme* (обязательно) - указание протокола, сопровождается `://`
- *Host* (обязательно) - местоположение ресурса, может быть как доменное имя, так и IP-адрес
- *Port* (по умолчанию 80 для http://, 443 https://)
- Path
- Query String (?key=value&key=value...)

### Примеры заголовков запроса:
- Host
- User-Agent - описание клиента, который запрашивает ресурс. информация о пользовательском окружении
- Refer - откуда поступил текущий запрос
- Accept - принимающий тип медиафайлов у клиента 
- Cookie -  формат cookie=value. Куки представляют собой небольшие фрагменты данных, которые хранятся как на стороне клиента, так и на сервере, и выступают в качестве идентификатора. Куки передаются вместе с запросом для поддержания доступа клиента к ресурсу.
- Authorization - метод идентификации клиента на сервере. После успешной идентификации сервер возвращает токен, уникальный для каждого конкретного клиента. В отличие от куки, данный токен хранится исключительно на стороне клиента и отправляется клиентом только по запросу сервера.

### Примеры заголовков ответа:
- Server - Server: nginx - информация о сервере, который обработал запрос
- Set-Cookie - Set-Cookie:PHPSSID=bf42938f - Содержит куки, требуемые для идентификации клиента. Браузер парсит куки и сохраняет их в своем хранилище для дальнейших запросов.
- **WWW-Authenticate** - WWW-Authenticate: BASIC realm=»localhost» - Уведомляет клиента о типе аутентификации, который необходим для доступа к запрашиваемому ресурсу.

### HTTPS 
Расширение HTTP протокола путем объединения HTTP и SSL или HTTP и TLS
Протоколы TLS (Transport Layer Security), SSL (Secure Socket Layer) - криптографические. Позволяют шифровать данные, в данном случае между браузером и сервером.
! TLS основан на SSL, но второй устарел и используется TLS

Перед тем как запустить HTTP-соединение, браузер обращается к серверу, чтобы наладить защищенное соединение. Сервер отправляет копию сертификата безопасности в ответ.

Браузер проверяет данные по своим спискам доверенных центров (список есть в каждом браузере), проверяет совпадение CN с доменным именем, даты выпуска и срока окончания сертификата, отсутствие в CRL, поддерживаемые алгоритмы, наличие издателя в списке доверенных корневых сертификатов и в списке доверенных издателей. В случае проблем на любой из этих проверок сертификат считается невалидным.

Если все хорошо, то браузер считает ресурс безопасным: они выбирают алгоритм шифрования, обмениваются ключом шифрования и потом данными по протоколу HTTP.

![[Pasted image 20250220154901.png]]

Типы SSL/TLS сертификатов: (от небезопасный к безопасным)
- Самоподписанные
- Групповые - CloudGlare, Let\`s Encrypt 
- Подписанные доверенным центром сертификации

Сертификаты по уровню проверки и организации в HTTPS
- Domain validation
- Organization Validation
- Extended Validation

## DNS (Domain Name System)
Система доменных имен - используется для преобразования доменного имени в IP-адрес и обратно. Состоит из множества DNS-серверов, на которых хранится информация о соответствии доменных имен и IP-адресов. Работает от домена третьего уровня к первому

Приоритетные IP-адреса хранятся в файле `hosts`

### Типы записей DNS-сервера
В DNS есть специальные файлы, которые хранят связи между доменами и их IP-адресами. Также они хранят информацию о поддоменах, почтовых серверах. Это все - **DNS-зона**.
Типы записей:
- A - IP-адрес обычного сайта
- MX - адрес почтового сервера
- CNAME - запись для поддоменов, которая указывает, к каким адресам прикреплен основной домен.
- NS - адрес сервера, где находятся все ресурсные записи
- TXT - текстовая информация для конкретного домена
- SPF - список серверов, которые могут отправлять сообщения от имени указанного домена
- SOA - главная запись зоны, где указаны все сведения о сервере

### Типы DNS-серверов
- Авторитативные - находятся на низшей ступени иерархии, хранят ресурсные записи и стремятся вернуть IP-адреса
- TLD-серверы - хранят домены верхнего уровня некоторого хоста.
- Корневые - находятся на самом верхнем уровне древовидной системы доменных имен. Количество таких серверов - 13.  Анализируют запросы на информацию о доменах верхнего уровня и контролируются аккредитованными ICANN организациями.

Если DNS-сервер не может преобразовать запрос, он направляется на корневой, который в свою очередь перенаправляет его по иерархии ниже на TLD-сервера

#### Типы DNS-запросов
DNS-запросы - запросы от одного сервера к другому.
- Итеративные - отправляются, если резолвер не способен вернуть ответ из-за того, что он не закеширован.
- Рекурсивные - первоначальные запросы поиска DNS. Их делают пользователи к резолверу. Резолвер - специальный механизм, преобразующий имена хостов в IP-адреса. Чаще всего рекурсивные параметры отправляются провайдеру интернета.
- Нерекурсивные - запросы к резолверу, который немедленно возвращает результат. Резолвер возвращает результат сразу, если запросы сразу попадают на авторитарный сервер или в локальном DNS-сервере закеширован требующийся IP-адрес.

### FQDN (Fully Qualified Domain Name)
Полное доменное имя - полный адрес компьютера или интернет-хостинг в системе доменных имен (DNS). FQDN представляет собой уникальную текстовую метку, которая позволяет однозначно идентифицировать ресурс в глобальной сети. 
Так же для идентификации используются IP-адеса и MAC-адреса.
Преимущества:
- идентификатор, который помогает однозначно отличить устройство от других в сети. FQDN упрощает управление сетью, а также поиск и устранение сетевых неполадок. 
- обеспечение мер безопасности, таких как внесение IP-адресов в белый список.
- соответствует стандартам IETF
- производительность сети, кеширование DNS

FQDN имеет иерархическую структуру, которая определена системой доменных имен. Полное доменное имя состоит из нескольких частей, которые вместе образуют уникальную комбинацию, позволяя идентифицировать ресурс в сети.
Синтаксис: `<Имя хоста>.<Поддомен>.<Домен второго уровня>.<Домен верхнего уровня>.<Корневой домен>`

#### Корневой домен
Начальный уровень в структуре доменных имен, обозначающий самую верхнюю точку в иерархии. Не имеет собственного имени и обозначается точкой `.` и расположен в самом конце FQDN.
#### Домен верхнего уровня (TLD)
Указывает доменную зону. Может быть 2 типов:
- географического (ru, kz, uk)
- административного (com, edu) - указывает тип организации

#### Домен второго уровня (SLD)
Уникальное имя ресурса, зарегистрированное в какой-либо и доменных зон. Расположен перед доменом верхнего уровня

#### Поддомен
Необязательный уровень поддоменов. У одного домена второго уровня может быть несколько поддоменов.

#### Имя хоста
Уникальный идентификатор серверной службы или сетевого узла, доступного в сети. В зависимости от типа устройства и его роли в сети, имя хоста может содержать различную информацию. `www.example.com`, `www` - имя хоста.
Часто встречающиеся имена хостов:
- ftp
- admin
- mail

### PQDN (Partially Qualified Domain Name)
Домен и доменное имя используются как синонимы, но домен - область пространства иерархических имен сети интернет, которая обозначается уникальным доменным именем. (дом - домен, доменное имя - адрес)

PQDN - часть полгого доменного имени, которое не включает в себя всю иерархию доменного пространства
## POP3 (Post Office Protocol Version 3)
Протокол почтового отделения версии 3.
## IMAP (Internet Message Access Protocol)
Протокол доступа к электронной почте.
## SMTP (Simple Mail Transfer Protocol)
Простой протокол передачи почты.

## Telnet (Terminal Network)
Telnet (telecommunications network) — это сетевой протокол (работающий по TCP-соединению), предназначенный для ручного управления удаленными машинами с помощью команд консольного терминала.

С помощью Telnet команды вводятся на локальной машине, а выполняются на удаленной. То есть пользователь сперва вводит IP-адрес и порт (по умолчанию 23) удаленного сервера, после чего выполняет команды на нем.

Старее SSH, в большей степени уязвим к перехватам. Используется текстовая авторизация

## SSH (Secure Shell)
**SSH** — это протокол прикладного уровня для безопасного обмена информацией между двумя устройствами. При передаче по SSH информация шифруется, поэтому протокол используется для работы в незащищенных сетях, чтобы обеспечить высокий уровень защиты. К частыми сценариями его использования можно отнести работу с удаленными машинами и передачу файлов на устройства.

Работа SSH-протокола базируется на нескольких этапах:
- открытие транспортного канала аутентификации - используется TCP-соединение
- аутентификация
- подключение - после установки соединения происходит обмен данных о версии протокола, тип шифрования, метод обмена ключами, алгоритмы сжатия данных и тд. 

![[Pasted image 20250221140438.png]]

Типы применяемый ключей:
- симметричные - для шифрования и дешифрования информации используется один и тот же ключ
- ассиметричные - для шифрования и дешифрования информации используется приватный (защищенный, для дешифрования) и публичный (незащищенный, передаваемый для шифрования) ключи. Приватный хранится на устройстве, а публичный распространяется между устройствами, с которыми устанавливается соединение

При одинаковой длине симметричного и асимметричного ключей криптостойкость первого будет выше криптостойкости второго. Это влияет на расходы при обмене информацией: снижение длины ключа ведет к снижению требований к оборудованию для шифрования. 

**Криптостойкость** — это свойство, измеряемое совокупностью количества действий и затраченных ресурсов для расшифровки сообщения без наличия ключа, проще говоря это количество ресурсов затраченных на подбор ключа.

При работе SSH-соединения взаимодействие происходит гибридно: ассиметричный для установки соединения, а симметричный (сеансовый) для последующего шифрования данных. Сеансовый ключ можно менять во время или после передачи определенного количества трафика.

Как происходит выбор сеансового ключа:
1. Сервер высылает свой публичный ассиметричный ключ
2. Клиент случайным образом выбирает сеансовый ключ
3. Клиент шифрует сеансовый ключ с помощью публичного, который получен от сервера, и передает его на сервер
4. С помощью приватного асимметричного ключа сервер расшифровывает сеансовый, который получен от пользователя
5. Далее при обмене данными используется сеансовый ключ до момента его обновления, когда алгоритм повторяется заново

При подключении к серверу каждый ключ обладает уникальной контрольной суммой (отпечатком/*fingerprint*) что не дает возможности другому пользователю авторизоваться под другим пользователем. 

## FTP (File Transfer Protocol)
Протокол передачи файлов.

## TFTP (Trivial File Transfer Protocol)


# Протоколы транспортного уровня
## UDP (User Datagram Protocol)
Описан в RFC768
Используется для "связи без установки соединения" (connectionless communication). Один узел сети отсылает пакеты, адресуя их другому узлу. Отправитель не ждет подтверждения о том, что получатель принял предыдущие пакеты.
UDP протокол отлично подходит для передачи данных в реальном времени. Например, когда идет видео-конференция или когда вы играете в многопользовательскую онлайн игру.
UDP единственный протокол транспортного уровня в стеке TCP/IP, который может использоваться для передач группового трафика.

Заголовок UDP-пакета состоит из 8 байт:
- порт отправителя
- порт получателя
- длина датаграммы
- контрольная сумма

![[Pasted image 20250213150131.png]]


## TCP (Transmissin Control Protocol)
Описан в RFC793
Между клиентом и сервером происходит соединение для проверки доставки пакетов. Перед отправкой данных сервер и клиент должны установить соединение - рукопожатие.

Рукопожатие происходит в 3 этапа:
1. Клиент посылает сервер пакет SYN
2. Сервет отвечает пакетов SYN-ACK
3. Клиент отвечает серверу пакетов ACK

![[Pasted image 20250213152351.png]]

Для завершения рукопожатия используется флаг FIN, возможно использование RST.

Решаемые задачи во время передачи данных:
- сегменты доставлены в нужном порядке
- сегменты доставлены
- контроль потока пакетов, для избегания перегрузки узлов сети 

Заголовок TCP минимум 20 байт:
- порт отправителя
- порт получателя
- порядковый номер (Sequence number) - сколько данных отправитель послал в сторону получателя. Номер увеличивается на 1 каждый раз, когда отправитель посылает пакеты с флагом SYN, FIN, так же увеличивается на размер полезных данных если они были переданы. Число, указанное в номере не учитывает текущий пакет. Порядковый номер первого пакета, посылаемого клиентом, всегда равен 0. 
- номер подтверждения (Acknowledgement number) - показывает сколько данных отправитель этого пакета получил на текущий момент. Отзеркаливает порядковый номер на 1 больше. Первый пакет всегда равен 1.
- длина заголовка
- флаги - названия пакетов для установки рукопожатия
- размер окна
- контрольная сумма
- указатель важности
- дополнительные опции

![[Pasted image 20250213150832.png]]

# Сетевой уровень
MAC IP ICMP ARP
Межсетевой уровень используется, чтобы описать обеспечение такого взаимодействия.

Межсетевое взаимодействие — это основной принцип построения интернета. Локальные сети по всему миру объединены в глобальную, а передачу данных между этими сетями осуществляют магистральные и пограничные маршрутизаторы.

## IP (Internet Protocol)

Описывает правила адресации и межсетевое взаимодействие устройств. Ключевая особенностью протокола является адресация. Протокол описан в RFC 791
IP адрес - уникальный составной числовой идентификатор. Числовой идентификатор состоит из адреса сети и адреса узла этой сети.

Существует две версии IP - IPv4, IPv6. Четвертая версия выделяет под адрес 4 байта (32 бита), что позволяет работать 4 миллиардам устройств. Для увеличения числа устройств был разработан IPv6, где под адрес выделяется 8 байт (128 бит)

Кадр IP-протокола
![[Pasted image 20250221212836.png]]

Структура:
1. Версия IPv4/IPv6
2. IHL (Internet Header Length - размер заголовка)
3. Тип обслуживания - обслуживает размер очередей QoS (Quality of Service). Происходит при помощи байта, который указывает на определенный набор критериев (требование ко времени задержки, пропускной способности, надежности)
4. Длина пакета - Размер пакета. Если **IHL** отвечает только за размер полей в заголовке (заголовком являются все поля на картинке, кроме поля данных), то длина пакета отвечает за весь пакет в целом, включая пользовательские данные.
5. Время жизни (TTL - time to live) - используется для предотвращения циклического пути пакета. При прохождении через маршрутизатор, значение уменьшается на единицу, и когда достигает нуля, пакет отбрасывается.
6. Протокол - указание транспортного протокола
7. Контрольная сумма заголовка - считается целостность полей заголовка, ! не данных
8. Опции - используется для расширения стандартного заголовка IP
9. Смещение - Указывает, какому месту принадлежит фрагмент в оригинальном IP. Это значение всегда кратно восьми байтам.
10. Данные
11. Идентификатор - Это 4-х байтовое число, которое показывает, что все части разделенного пакета одно единое целое.
12. Флаги - Указывает, что это не единый, а фрагментированный пакет.
13. Смещение фрагмента - Сдвиг относительно первого фрагмента. То есть это нумерация, которая поможет собрать IP-пакет воедино.
14. IP-адрес отправителя и IP-адрес получателя
### IPv4
IPv4: адрес представляется в виде четырех десятичных чисел значениями от 0 до 255
Пример: 192.168.0.3
Длина IPv4 32 бит

![[Pasted image 20250522200409.png]]

Каждый рязряд называется октетом. Максимальное число в октете 255, минимальное 0.

У всех IP адресов есть две части: сеть и узел.

- **_Сеть_** – это та часть IP, которая не меняется во всей сети и все адреса устройств начинаются именно с номера сети.
- **_Узел_** – это изменяющаяся часть IP. Каждое устройство имеет свой уникальный адрес в сети, он называется узлом.

IP адрес не может существовать без маски подсети.
Маска подсети - двоичное число, при поразрядном выполнении логической операции `и` отображает адрес сети

Все единицы в маске могут идти только последовательно. Маску могут указывать через слеш в виде количества единиц, которые записываются слева-направо, например 192.168.0.1/16. Такая запись называется **префиксной**. 

По количеству нулей в маске можно понять, сколько устройств может работать в сети. Для этого нужно возвести двойку в степень равную количеству нулей.

Нужно учитывать, что у каждой сети есть два зарезервированных адреса - broadcast (самый последний адрес) и, собственно, сам адрес сети. Их нужно исключать из найденного ранее числа.

![[Pasted image 20250221184102.png]]

### IPv6
IPv6: адрес представляется в виде восьми четырехзначных шестнадцатеричных чисел (от 0 до F). Ведущие нули опускаются. Нулевые группы идущие подряд, могут быть опущены, но не более одного пропуска. Каждое число разделенное точками называют хекстетом.
Пример: 2001:0db8:85a3:0000:0000:8a2e:0370:7334
Длина IPv6 128 бит
![[Pasted image 20250522200449.png]]

Решает проблему нехватки адресов IPv4 в сети, также:
- отсутствие широковещательных пакетов. В IPv6 нет ARP протокола, он не нужен (в IPv4 для разрешения IP в MAC использовался ARP. В IPv6 эту задачу взял на себя NDP. Но он совсем другой и работает поверх ICMPv6. Т.е. от ARP отличается и структурой и уровнем работы.)
- Нет нужны использовать NAT
- Мобильность - хост может переезжать из одной сети в другую со своим IP адресом
- IPsec - встроенный механизм использования IPsec (безопасный IP)
- Улучшенный заголовок, нет нужды считать контрольную сумму (IPv6 создан как замена для IPv4. Без необходимости подсчета контрольной суммы маршрутизация IPv6 пакетов будет быстрей. А за целостность пакета пусть отвечают заголовки L2 (Ethernet считает контрольную сумму всего пакета в поле FCS) и L4 (TCP считает контрольную сумму для себя).)

#### Запись IPv6

- Самую длинную подпоследовательность 0 можно удалить, но только 1 раз
- Хекстет полностью состоящий из 0 можно заменить на 0
- Лидирующие 0 можно убрать

Пример:
2001:0DB0:0000:123A:0000:0000:0000:0030.

Для начала используем правило 2 и уберем все лидирующие 0, получим: 2001:DB0:0:123A:0:0:0:30

А теперь воспользуемся правилом 1, найдем самую длинную подпоследовательность из 0 и уберем ее. В результате получим 2001:DB0:0:123A::30.

#### Типы адресов в IPv6
- Глобальный юникаст - аналог публичных адресов в IPv4. Все адреса, у которых первые 3 бита равны "001", что значит диапазон от 2000 до 3FFF
- Локальные адреса - взаимодействие с другими устройствами в локальной сети. Диапазон от FE80::/10
- Групповые адреса - для мультикастовой рассылки. Диапазон от FE00::/8
- Loopback - специальный адрес ::1 аналог localhost
- Неопределенный адрес (unspecified asddress) - все 0, ::. 
- Уникальные локальные адреса (unique local) - аналог приватных сетей
- Адреса IPv4, отображенные в IPv6 (IPv4 embedded) - адреса вида ::ffff:xxxx:xxxx, где xxxx:xxxx – это некоторый IPv4 адрес, переведенный в шестнадцатеричный вид.
### Частные IP-диапазоны
Все адреса делятся:
- публичные/глобальные/внешние (белые) - используются в сети Интернет
- частные/локальные/внутренние (серые) - используются в локальной сети
Серые адреса используются в закрытых локальных сетях. Выход в интернет, используя частный IP-адрес, невозможно. В этом случае связь с Интернетом осуществляется через NAT (Network Address Translator) трансляция сетевых адресов заменяет частный IP-адрес на публичный.
Частные IP-адреса в пределах одной локальной сети должны быть уникальны и не могут повторяться.

- От 10.0.0.0 до 10.255.255.255 с маской 255.0.0.0 или /8
- От 172.16.0.0 до 172.31.255.255 с маской 255.240.0.0 или /12
- От 192.168.0.0 до 192.168.255.255 с маской 255.255.0.0 или /16
- От 100.64.0.0 до 100.127.255.255 с маской подсети 255.192.0.0 или /10; данная подсеть рекомендована согласно rfc6598 для использования в качестве адресов для CGN (Carrier-Grade NAT).

- 10.0.0.0/8
- 172.16.0.0/12
- 192.168.0.0/16
Эти сети описаны в RFC1918 и эти адреса не могут быть использованы в сети интернете, могут быть использованы в частных нуждах: дом, офис... Чтобы хост с IP адресом из частной сети мог обмениваться данными с хостами в сети Интернет, его IP адрес будет подменяться на IP адрес маршрутизатора. Такая функция подмены IP адреса называется NAT, еще называют Masquerading (маскарадинг)
### Глобальные IP-адреса
Глобальные адреса называются белыми, выдаются в аренду.

Провайдер выдает на время (при каждом подключении к сети) временный IP-адрес. Для разворачивания сайта на сервере для глобального адреса необходим глобальный адрес. Для получения необходим интернет-провайдер, провайдер обращается к локальному Интернет регистратору (LIR - Local Internet Registry), который выдает набор IP адресов провайдеру, провайдер из списка выделяет один адрес. LIR обращается за адресами к RIR (Regional Internet Registry), RIR к IANA (Internet Assigned Numbers Authority), IANA к ICANN (Internet Corporation for Assigned Names and Numbers)

### Маршрутизаторы
Маршрутизатор и роутер (router) - это синонимы для одного устройства.

Таблица маршрутизации состоит из 
- IP адреса назначения
- IP адреса маршрутизатора
На каждом хосте прописывается своя таблица. В случае если устройства находятся в одной сети, то маршрутизатором выступает сам хост, если устройство в другой сети то запрос отправляется в маршрутизатор, который сам будет в своей сети нужный адрес.

Пример 
Для малого числа хостов, для большой сети неудобно хранить такой объем информации

![[Pasted image 20250507191944.png]]

| **IP адрес назначения** | **IP адрес маршрутизатора** |
| ----------------------- | --------------------------- |
| 10.0.0.2                | 10.0.0.1                    |
| 10.0.0.5                | 10.0.0.1                    |
| 10.0.0.100              | 10.0.0.1                    |
| 172.16.0.3              | 10.0.0.100                  |
| 172.16.0.4              | 10.0.0.100                  |

### Классовая адресация сетей
Исторически весь диапазон IP (все 4 байта) разбили на 5 классов сетей (A, B, C, D, E). Это означало, что одна часть IP адреса указывает на класс сети, а остальная идентифицирует хост. 

**Сети класса А** лежат в диапазоне от 0.0.0.0 до 127.255.255.255. Для идентификатора сети используется 1 байт, а остальные 3 байта для идентификации хоста

![[Pasted image 20250507192839.png]]

В одной сети класса А может находиться до 16 777 215 (256 * 256 * 256) хостов. Правда, таких сетей не много, всего 128. Вот пример некоторых сетей класса А:

- 8.0.0.0    - 8.255.255.255
- 10.0.0.0 - 10.255.255.255
- 104.0.0.0 - 104.255.255.255

**Сети класса B** лежат в диапазоне от 128.0.0.0 до 191.255.255.255. Для идентификатора сети используется первые два байта, а остальные 2 байта для идентификации хоста

![[Pasted image 20250507192911.png]]

В одной сети класса B может находиться до 65 535 (256 * 256) хостов. Вот пример некоторых сетей класса B:

- 169.254.0.0 - 169.254.255.255
- 172.16.0.0 - 172.16.255.255
- 190.56.0.0 - 190.56.255.255

**Сети класса C** лежат в диапазоне от 192.0.0.0 до 223.255.255.255. Для идентификатора сети используется первые 3 байта, а оставшийся байт для идентификации хоста

![[Pasted image 20250507192935.png]]

В одной сети класса C может находиться всего 255 хостов. Вот пример некоторых сетей класса С:

- 192.168.1.0 - 192.168.1.255
- 204.16.6.0 - 204.16.6.255
- 220.215.65.0 - 220.215.65.255

**Сеть класса D** от 224.0.0.0 до 239.255.255.255. Класс D - это одна сеть и ее адреса используется для групповых адресов. Часто, IP адреса из этого класса назначают себе принтеры, сканеры, маршрутизаторы и другие устройства работающие по сети. 

**Сеть класса E** от 240.0.0.0 до 255.255.255.255. Класс E - это тоже одна сеть и ее адреса используется для служебных целей.

Благодаря классовой адресации любой хост может определить IP адрес находится в его сети или другой.

Пример
Проблема заключается в негибкости. Если нужно 4000 IP то какой брать 16 классов C или 1 класс B и что делать с неиспользованными адресами
![[Pasted image 20250507193246.png]]

| **IP адрес назначения** | **IP адрес маршрутизатора** |
| ----------------------- | --------------------------- |
| 10.0.0.0                | 10.0.0.1                    |
| 172.16.0.0              | 10.0.0.100                  |
Если адрес назначения находится в сети 10.0.0.0 (напомню, это класс A и адреса в этой сети лежат в диапазоне от 10.0.0.0 до 10.255.255.255), то адрес маршрутизатора 10.0.0.1, т.е. мы сами будем доставлять пакет на этот хост.

А если адрес назначения находится в сети 172.16.0.0 (это класс B и адреса для этой сети лежат в диапазоне от 172.16.0.0 до 172.16.255.255), то адрес маршрутизатора 10.0.0.100.

Таким образом, даже если завтра мы добавим 1000 новых хостов в обе сети, то для хоста 1 ничего менять не придется. Он так же успешно сможет доставлять пакеты как внутри своей IP сети, так и для сети 172.16.0.0. И никаких новых записей в таблицу маршрутизации вводить не придется.

### Бесклассовая адресация сетей
Бесклассовая адресация - метод IP адресации, позволяющий гибко управлять пространством IP адресов. Бесклассовая адресация предлагает вместо жестко закрепленных правил адресации сети использовать маску подсети. Цель маски сказать, какие биты в IP адресе указывают на идентификатор сети, а какие биты указывают на идентификатор хоста. 

Пример
Для примера рассмотрим IP сеть класса B 172.16.0.0. В этой сети первые 2 байта IP адреса указывают на идентификатор сети, а следующие два байта указывают на идентификатор хоста.

Запишем точно такую же сеть в бесклассовой адресации. Помимо IP адреса понадобится еще маска подсети (маска, маска сети, маска подсети - это все одно и тоже). Адрес сети будет прежний, 172.16.0.0, а маска подсети будет 255.255.0.0.

![[Pasted image 20250507200851.png]]

Там, где бит у маски подсети установлен в 1, означает, что соответствующий бит в IP адресе указывает на идентификатор сети. А там, где бит у маски подсети  установлен в 0, означает, что соответствующий бит в IP адресе указывает на идентификатор хоста. Так как в нашей сети первые два байта (16 бит) указывают на идентификатор сети, то и первые 16 бит маски подсети должны быть установлены в 1. В десятичной записи 8 бит установленных в 1 дают число 255. Поэтому первые два байта нашей маски 255.255.

С идентификатором хоста делаем так же. В нашей сети для идентификации хоста выделены вторые 2 байта. Значит это место в маске мы заполняем 0. 

Таким образом, сеть класса B 172.16.0.0 можно записать в бесклассовой адресации как 172.16.0.0/255.255.0.0. Обычно маска подсети записывается через слеш (/) после IP адреса сети.

Маска делит IP адрес на две части, одна часть - идентификатор сети, вторая часть - идентификатор хоста. Например, 192.168.1.0/24:

- первые три байта: 192.168.1 - идентификатор сети
- последний байт - идентификатор хоста

Маска /32 означает конкретный IP адрес.

Чтобы определить, попадает ли IP адрес в сеть 172.16.0.0 c маской 255.255.0.0 мы делаем следующее:

1. Берем IP адрес, например, 172.16.0.3
2. Делаем операцию “побитовое И” с маской подсети
3. Полученный результат сравниваем с адресом сети
4. Если результат равен адресу сети, значит IP адрес принадлежит этой сети
5. Если нет, то и нет.

![[Pasted image 20250507200935.png]]

В нашем случае, IP адрес 172.16.0.3 принадлежит сети 172.16.0.0/255.255.0.0, так как после применения маски подсети мы получили адрес сети 172.16.0.0.

Если мы возьмем IP адрес 172.16.126.254 и тоже применим к нему маску 255.255.0.0, то в результат получим 172.16.0.0. Что будет указывать на то, что и этот IP адрес принадлежит сети 172.16.0.0.

По сути, там где у маски подсети стоит бит в 1 означает, что соответствующий бит в IP адресе останется таким, каким и был. А там, где у маски подсети стоит бит 0 означает, что соответствующий бит в IP адресе обнулится. Был он 1 или 0, неважно, он станет 0.

А теперь давайте возьмем IP адрес 172.13.0.3 и применим маску 255.255.0.0. В итоге получится 172.13.0.0, что не равно 172.16.0.0. Значит, IP адрес 172.13.0.3 не принадлежит сети 172.16.0.0.

Пример

Хост 1 имеет IP 10.0.0.1 и маску 24 означает, что хост 1 имеет IP 10.0.0.1, который принадлежит IP сети 10.0.0.0/24 (а это 10.0.0.0 - 10.0.0.255)
![[Pasted image 20250507201305.png]]

### Широковещательный адрес в IP сети

В каждой IP сети есть 2 зарезервированных адреса: первый и последний. Например, возьмем IP сеть 192.168.1.0/24.

Первый адрес сети будет 192.168.1.0 - это и есть адрес сети
Последний адрес 192.168.1.255 - шировещательный адрес для сети. Означает, что все хосты в этой сети будут принимать и обрабатывать пакет, если такой адрес будет указан в качестве назначения

### Обратная петля Loopback

Обратная петля, это сеть 127.0.0.0/8 для локального использования на каждом отдельном хосте. Можно вместо 127.0.0.1 написать 127.123.127.54 или любой другой IP адрес из IP сети 127.0.0.0/8. Все будет работать, как под ОС Windows, так и под ОС Linux.

### Маршрут по умолчанию

Запись  “для всех остальных IP сетей кроме моей идти на маршрутизатор” выглядит как 0.0.0.0/0. Т.е. нулевая сеть с маской 0. Получается, что в эту сеть попадает абсолютно любой IP адрес. Для любого IP адреса применив маску 0 получим 0.0.0.0.  
Введем порядок просмотра записи в таблице маршрутизации. Она просматривается от большей маски к меньшей. Т.е. первой будет просматриваться запись с маской 32, потом с 31, потом с 30 и так далее до 0.

Вот такая запись (0.0.0.0/0) и называется маршрутом по умолчанию, а IP-адрес маршрутизатора в этом случае называется "Маршрутизатор по умолчанию" или "Default gateway".

### Таблица маршрутизации

У каждого хоста, который подключен к глобальной сети Интернет, должна быть своя таблица маршрутизации. Именно благодаря таблице маршрутизации хост может принимать решения, когда он сам может доставлять пакеты по сети, а когда ему нужно отправить пакет на маршрутизатор.

Метрика в таблице маршрутизации нужна для приоритета. Если в таблице будет два одинаковых маршрута, то метрика позволит выбрать более приоритетный. Чем ниже метрика, тем более приоритетный маршрут. Например, для отказоустойчивости вы хотите сделать два маршрута по умолчанию. Чтобы всегда работал только один, а второй начал работать только при неработоспособности первого, можно воспользоваться метрикой.

### Default free Zone (DFZ)
Набор маршрутизаторов, которые вместе содержат все маршруты до всех сетей.

Пример

![[Pasted image 20250507204312.png]]

Это пример сети, когда мы не можем обойтись только маршрутами по умолчанию.  Если мы на маршрутизаторе 2 сделаем маршрут по умолчанию на маршрутизатор 3, то пакет от хоста 1 до хоста 2 сможет дойти. Но вот обратно нет, так как маршрутизатор 2 ничего не знает про сеть 10.0.0.0/24, а маршрут по умолчанию указывает на маршрутизатор 3.

А если мы на маршрутизаторе 2 сделаем маршрут по умолчанию на маршрутизатор 1, то картина будет обратной. От хоста 2 до хоста 1 пакеты будут доходить, а вот обратно нет.

Чтобы такая сеть работала нам нужно:

1. либо на маршрутизаторе 2 добавить в таблицу маршрутизации информацию про обе IP сети: 10.0.0.0/24 и 169.254.1.0/24 (как и сделано на рисунке 72а)
2. либо на маршрутизаторе 2 добавить в таблицу маршрутизации маршрут по умолчанию и информацию про одну из двух IP сетей. Например, в качестве маршрута по умолчанию выбрать маршрутизатор 1 и добавить информацию про IP сеть 169.254.1.0/24.

В первом случае в DFZ будет только маршрутизатор 2, так как он сам будет знать про все маршруты. А его таблица маршрутизации будет как в таблице 14.  
 
| **IP сеть назначения** | **IP адрес маршрутизатора**          |
| ---------------------- | ------------------------------------ |
| 192.168.1.0/24         | 192.168.1.102 (сам маршрутизатор 2)  |
| 172.16.12.0/24         | 172.16.12.102  (сам маршрутизатор 2) |
| 10.0.0.0/24            | 192.168.1.101  (на маршрутизатор 1)  |
| 169.254.1.0/24         | 172.16.12.103  (на маршрутизатор 3)  |

Во втором случае в DFZ будет маршрутизатор 2 и 1. Так как вместе они будут иметь маршруты до всех сетей.

### NAT (Network Address Translation)
Механизм в TCP/IP преобразовывающий частный адрес в глобальный. Устройство, которое отвечает за NAT, хранит в себе бд сопоставления адресов. Обычно, задачами NAT занимается маршрутизатор.
![[Pasted image 20250221195934.png]]

## ARP (Address Resolution Protocol)
предназначен для определения MAC-адреса другого компьютера по известному IP, описан в RFC 826. Инкапсулируется в Ethernet. Работает в формате запрос-ответ. В запросе указывается искомый IP адрес чей MAC адрес требуется найти, в ответ должен прийти искомый MAC адрес. 

![[Pasted image 20250221220217.png]]

Сам протокол имеет следующий формат

![[Pasted image 20250507185602.png]]

- **Sender hardware address (SHA)** - MAC адрес отправителя. 
- **SPA** - IP адрес отправителя
- **THA** - MAC адрес назначения
- **TPA** - IP адрес назначения

При успешном запросе ответ сохраняется в область памяти ARP кеш. Кеш представляет собой таблицу
- IP адрес
- MAC адрес
- Тип записи

Типы записей:
- динамический - запись была добавлена через работу ARP протокола и должна быть удалена через определенное время. Время определяется ОС
- статический - запись была добавлена не через ARP протокол и должна быть в кеше до выключения ОС.
## ICMP (Internet Control Message Protocol)
протокол, предназначенный для отправки сообщений об ошибках и передачи служебной информации, которая указывает на успех или неудачу при обмене данными с другим IP-адресом. Обычно ICMP не используется для передачи данных между устройствами, а применяется для проверки связи между двумя хостами с помощью программ, таких как ping или traceroute

Заголовок ICMP идет после заголовка IPv4 и идентифицируется как протокол 1. ICMP-пакеты содержат 8-битный заголовок и данные переменного размера. Поле Type указывает на тип пакета. Если значение равно 8 это запрос ICMP echo (ping), если 0 — ответ ICMP echo (ping).

![[Pasted image 20250221220337.png]]



## DHCP (Dynamic Host Confuguration Protocol)
DHCP — протокол прикладного уровня модели TCP/IP, служит для назначения IP-адреса клиенту. IP-адрес можно назначать вручную каждому клиенту, то есть компьютеру в локальной сети. Но в больших сетях это очень трудозатратно, к тому же, чем больше локальная сеть, тем выше возрастает вероятность ошибки при настройке. Поэтому для автоматизации назначения IP был создан протокол DHCP.

[DHCP-протокол: что это такое и как он работает](https://selectel.ru/blog/dhcp-protocol/)

# Канальный уровень
Задает параметры сигнала, а также какой вид и форму имеет сигнал. Вводится понятие - фреймы (биты). Единица измерения передаваемой информации.
Для передачи используется Ethernet, Wi-Fi, Bluetooth

Ещё одна важная задача канального уровня — проверять, что данные передаются безошибочно. Для этого протоколы используют свои средства проверки:

- Если возникла ошибка, устройство отправляет фрейм обратно, а второе устройство передаёт его ещё раз.
- Если всё прошло удачно, то фрейм передаётся на следующий уровень для обработки.
## Ethernet (CSMA/CD) протокол

CSMA/CD - Carrier Sense Multiple Access with Collision Detection - множественный доступ с прослушиванием несущей и обнаружением коллизий.
MA (Multiple Access) - множественный доступ означает, что любой хост в сети может отправить данные в сеть в любое время.

CS (Carrier Sense) - прослушиванием несущей, означает не отправлять данные в сеть, если кто-то другой уже передает что-то

CD (Collision Detection) - определение коллизий. При одновременной отправки данных с разных хостов, полученные данные во время коллизии данные отбрасываются и хосты начинают передачу последнего пакета снова. Коллизия может случится только в полудуплексном соединении, если полнодуплексное соединение, то коллизии не будет, так как для отправки и приема данных используются разные каналы. Домен коллизий - это сегмент сети, в котором может произойти коллизия.

Итого, алгоритм работы сети Ethernet следующий:

1. Каждый хост в сети Ethernet может передавать данные в любой момент времени.
2. Перед передачей данных сетевая карта проверяет несущую. Если никто в настоящий момент не передает данные, сетевая карта начинает передавать данные.
3. Если во время передачи данных сетевая карта определяет, что еще кто-то вместе с ней передает данные в сеть, то генерируется специальный JAM сигнал, сообщающий всем участникам сети, что произошла коллизия и текущий кадр с данными считать недействительным.
4. Возврат на второй пункт.

Все версии стандарта начинаются с 802.3
Кадр (PDU) Ethernet
![[Pasted image 20250221211728.png]]

1. Преамбула - используется для указания начала кадра
2. MAC-адрес получателя - записывается адрес получателя
3. MAC-адрес отравителя - записывается адрес отправителя
4. Тип (длина) - Если значение поля менее или равно 1500 (0x05DC), то значение трактуется как размер данных в Ethernet кадре. Если значение поля более или равно 1536 (0x0600), то значение трактуется как идентификатор вложенного протокола. если внутри Ethernet кадра будет лежать IP пакет, то значение поля будет 0x0800, а если ARP пакет, то значение 0x0806, IPv6 - 0х6DD.
5. SNAP/LLC - данные полученные с высших уровней или полезные данные
6. FCS (Frame Check Sequence - контрольная сумма кадра) - подсчитана чек-сумма. Gоле содержит CRC32. CRC (Cyclic redundancy check) - алгоритм нахождения контрольной суммы, предназначенный для проверки целостности данных. При несовпадении чек суммы пакет отбрасывается

На уровне используется MAC-адресация
### MAC-адресация

MAC (Media Access Control) - часть уровня (канального), которая отвечает за обеспечение доступа к линиям связи и адресацией хостов (конечных узлов). Отвечает за множественный доступ к сети. Использует топологии *шина*, *кольцо*. Из сетевого оборудования - концентратор (хаб).

MAC-адрес - уникальный идентификатор - шестибайтовый номер, записывается в виде шестнадцатеричного числа. 3 старших байта (24 бита) отводится как идентификатор организации (OUI). Организация запрашивает OUI у IEEE Registration Authority. Оставшиеся 3 байта (24 бита) отводятся под идентификацию выпускаемых устройств. Всегда состоит из 12 букв и/или цифр. Есть возможность изменить MAC-адрес в реестре. 
Пример: 00-50-B6-5B-CA-6A

MAC адреса делятся на 3 типа:
- Unicast - персональный MAC адрес. Имеет каждая сетевая карта, прошивается на заводе или устанавливается вместе с драйверами
- Multicast - групповой MAC адрес, начинается на 01:00:5E. Присваивается в случае, когда ожидается рассылка пакетов сразу группе хостов.
- Broadcast  - широковещательный MAC адрес, записывается как все биты установленные 1 или  шестнадцатеричном формате FF:FF:FF:FF:FF:FF. Такой адрес в поле получателя означает, что пакет должен быть обработан всеми хостами, которые получили данный пакет.
## Свитч

Свитч (он же коммутатор) - активное сетевое оборудование, которое работает на втором уровне модели ISO/OSI. Т.е он уже может работать с Ethernet кадрами. Пытается отправить Ethernet пакеты в тот порт, куда подключен хост назначения. Во время работы свитч запоминает MAC адреса отправителей в специальной таблице под названием таблица коммутаций. Свитч запоминает только MAC адреса только отправителя.

Таблица коммутации состоит из двух колонок:

- MAC адрес
- Номер порта, к которому подключен хост с данным MAC адресом.

### Алгоритм работы 

Пусть в нашем случае, хост 1 отправит пакет хосту 2. Алгоритм работы свитча следующий:

- Изначально, как только свитч включают, его таблица коммутации пустая.
- Когда на свитч приходит пакет, он записывает в таблицу MAC адрес отправителя и номер порта, на который этот пакет пришел. Т.е в нашем случае на порт 1 приходит Ethernet пакет с MAC адресом отправителя 00:00:00:00:00:01 и в таблицу коммутации добавляется запись:

| **MAC адрес отправителя** | **Порт свитча** |
| ------------------------- | --------------- |
| 00:00:00:00:00:01         | 1               |
- Дальше свитч пытается отправить пакет в тот порт, куда подключен получатель. Для этого он достает из Ethernet пакета MAC адрес получателя (00:00:00:00:00:02) и ищет его в своей таблице коммутации. В нашем случае, такого адреса в таблице коммутации нет. В этом случае свитч работает как хаб, отправляет пакет во все остальные подключенные порты. Т.е. в порт 2 и 3.

Что произойдет, если в сети будет 2 хоста с одинаковыми MAC адресами?

**Ответ**: В этом случае, по мере того, как хосты с одинаковыми MAC адресами будут отправлять пакеты в сети, свитч будет переписывать MAC адрес то для одного, то для другого порта. Это приведет к тому, что часть пакетов, которые будет предназначаться для этого MAC адреса будет приходить для одного хоста. А другая часть пакетов придет второму хосту.

Обладая оперативной памятью свитч имеет буферы для отправки пакетов. Если на два разных порта, например на порт 1 и 2 одновременно поступят пакеты. То это не вызовет коллизию, как в случае с хабом. Свитч положит эти пакеты к себе в оперативную память, потом решит, в какой порт их необходимо отправить и разместит их в буфере на отправку.

Широковещательный домен - группа доменов коллизий, соединенных с помощью устройств второго уровня. Иными словами, это участок компьютерной сети, в котором все узлы могут передавать данные друг другу с помощью широковещательного пакета (когда MAC адрес назначения равен FF:FF:FF:FF:FF:FF) на канальном уровне сетевой модели OSI.

![[Pasted image 20250507175903.png]]
https://miminet.ru/web_network_shared?guid=d5eb566d-402e-442f-a98a-d5341568a5c9

# Физический уровень

Хаб работает на физическом уровне модели ISO/OSI и представляет собой небольшую коробку с портами для подключения. Получив сигнал на любой порт из подключенных, хаб передает его во все остальные подключенные порты.

# VLAN
VLAn (Virtual Local Area Network) - позволяет разделить единую сеть (широковещательный домен) на изолированные друг от друга сегменты сети
VLAN изолирует один сегмент сети от другого путем назначения идентификатора виртуальной сети (VLAN Id).

VLAN реализуется на свитчах путем назначения VLAN ID (идентификатор виртуальной сети) конкретному порту компьютера.
После получения коммутатором пакета на порт он определяет какому VLAN ID принадлежит данный порт. Определив VLAN ID, он коммутирует пакеты только в рамках данного VLAN ID.

## Trunk VLAN (теги/метки)

Стандарт IEEE 802.1Q описывает процедуру тегирования трафика. 802.1Q помещает внутрь Ethernet фрейма тег, который передаёт информацию о принадлежности трафика к VLAN.

![[Pasted image 20250522202811.png]]

Заголовок 802.1Q имеет размер 4 байта и помещается между полями MAC-адрес источника и полем Тип/Длина.
Заголовок состоит из
- TPID  (Tag Protocol Identifier, 16 бит) - указывает какой протокол используется для тегирования. Для 802.1Q используется значение 0x8100.
- TCI (Tag control information. 16 бит) состоит из следующих полей:
	- Priority code point (PCP, 3 бита) - используется стандартом IEEE 802.1p для задания приоритета передаваемого трафика (class of service). Число 0 соответствует наименьшему приоритету, а 7 — наивысшему.
	- Drop eligible indicator (DEI, 1 бит) - индикатор допустимости удаления. Может использоваться отдельно или совместно с PCP для указания кадров, которые могут быть отброшены при наличии перегрузки.
	- **VLAN Identifier** (12 бит) - указывает, какому VLAN ID принадлежит кадр.

Для настройки тегированого VLAN на коммутаторе нужно перевести порт в состояние Trunk и назначить ему идентификаторы VLAN.

Сабинтерфейс - это виртуальный интерфейс сетевого уровня, который умеет отправлять и получать пакеты с VLAN тегом (IEEE 802.1q).